import{ab as r,bb as I,cb as L,db as A,eb as v,o as h}from"./chunk-37ZJ7F5R.js";import{U as f,a,b as l,na as p,nc as d}from"./chunk-UGKDFCWG.js";var S=[],y=["/imgs/profile-img-1.jpg","/imgs/profile-img-2.jpg","/imgs/profile-img-3.jpg","/imgs/profile-img-4.jpg"],D=I({providedIn:"root"},v({accountsList:S,imgsDefault:y}),A(t=>{let u=f(h);return{addToAccountsList:s=>{let o=s.sub;if(o){let i=t.accountsList().some(e=>e.sub==o),n=t.accountsList().some(e=>e.email==s.email);!i&&!n&&(s=l(a({},s),{isPassGoogle:!0}),r(t,{accountsList:[...t.accountsList(),s]})),u.navigateByUrl("")}else{let i=t.imgsDefault()[Math.floor(Math.random()*t.imgsDefault().length)];o=crypto.randomUUID().replace(/-/g,"").slice(0,21),s=l(a({},s),{sub:o,isPassGoogle:!1,picture:i}),r(t,{accountsList:[...t.accountsList(),s]})}},ifEmailExist:s=>p(t.accountsList())().some(i=>i.email===s),setAccountPasswordForGoogle:()=>{let o="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789!@#$%^&*()-_=+[]{}",i="",n=new Uint32Array(12);crypto.getRandomValues(n);for(let e=0;e<12;e++)i+=o[n[e]%o.length];return i},checkIfAccountExistOrNo(s,o,i){if(o===i){if(t.accountsList().some(e=>e.email==s))return r(t,{accountsList:t.accountsList().map(e=>e.email===s?l(a({},e),{password:o,isPassGoogle:!1}):e)}),!0}else return!1;return!1},setAccountsListWhenRefresh(s){r(t,{accountsList:[...t.accountsList(),s]})},toggleMovieWishlist(s){let o=sessionStorage.getItem("user_id");if(!o)return;let i=JSON.parse(o),n=i.wishList?.movies??[],m=n.some(c=>c.id===s.id)?n.filter(c=>c.id!==s.id):[...n,s],g=l(a({},i),{wishList:{movies:m,tvShows:i.wishList?.tvShows??[]}});sessionStorage.setItem("user_id",JSON.stringify(g)),r(t,{accountsList:t.accountsList().map(c=>c.sub===i.sub?g:c)})},toggleMovieWishlistTv(s){let o=sessionStorage.getItem("user_id");if(!o)return;let i=JSON.parse(o),n=i.wishList?.tvShows??[],m=n.some(c=>c.id===s.id)?n.filter(c=>c.id!==s.id):[...n,s],g=l(a({},i),{wishList:{movies:i.wishList?.movies??[],tvShows:m}});sessionStorage.setItem("user_id",JSON.stringify(g)),r(t,{accountsList:t.accountsList().map(c=>c.sub===i.sub?g:c)})}}}),L({onInit(t){let u=localStorage.getItem("accountsListForMoviesApp");(u!==null||u)&&JSON.parse(u).forEach(s=>{t.setAccountsListWhenRefresh(s)}),d(()=>{let s=t.accountsList();localStorage.setItem("accountsListForMoviesApp",JSON.stringify(s))})}}));export{D as a};
